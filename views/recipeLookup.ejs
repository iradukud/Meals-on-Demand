<%- include('partials/header') -%>
<%- include('partials/nav') -%>

<main class="w-100 m-auto text-center">
  <!-- Heading & Image-->
  <img class="mb-2 mt-2" src="/imgs/bookImage.png" alt="bookImage" width="100">
  <h1 class="display-5 fw-bold lh-1 mb-3 text-center">Recipe Lookup</h1>

  <!-- Form that looks up recipes-->
  <section class="row justify-content-center">
    <div class="col-5 mt-3">
      <form class="d-flex form-floating" action="/apiRecipes/lookup" method="POST">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" name="searchItem">
        <label for="search">Recipe</label>
        <button class="btn btn-outline-secondary btn-lg px-4" type="submit">Search</button>
      </form>
    </div>
  </section>

  <%#- Recipes generated from the search request via API %>
  <% if (typeof recipes!='undefined') { %>
  <section class="row mt-5 px-5">


    <%# Loop through each all the recipes and present %>
    <%recipes.forEach(recipe => {%>

    <%# Container for Each recipe %>
    <div class="col-3 themed-grid-col mb-3">

      <div class="card shadow-sm">

        <%# Recipe image %>
        <a href="/apiRecipes/<%= recipe['recipe']['uri'].split('_').pop() %>">
          <img class="card-img-top" width="100%" height="300" src="<%= recipe['recipe']['image'] %>"></img>
        </a>

        <%# Recipe name %>
        <div class="card-body">
          <a href="/apiRecipes/<%= recipe['recipe']['uri'].split('_').pop() %>">
            <p class="card-text "><%= recipe['recipe']['label'] %></p>
          </a>
        </div>
      </div>

    </div>

      <%})%>
  </section>
  

  <div class="d-flex justify-content-around align-items-center px-4 mt-3 mb-5">
    <button onclick="history.back()" class="btn btn-outline-secondary btn-lg">Back</button>
    <%# Next papge from the api %>
    <form action="/apiRecipes/lookup" method="POST">
      <input type="hidden" name="searchItem" value="<%=searched%>">
      <input type="hidden" name="next" value="<%=nextRecipes%>">
    <button class="btn btn-primary btn-lg" type="submit">Next page</button>
    </form>
  </div>

  <% } %>

</main>


<%- include('partials/footer') -%>